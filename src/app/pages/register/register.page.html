<ion-header>
  <ion-toolbar>
    <ion-title>Crear cuenta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <form [formGroup]="form" (ngSubmit)="submit()">
    <ion-list lines="full">

      <ion-item>
        <ion-input
          label="Nombre"
          labelPlacement="floating"
          formControlName="name"
          inputmode="text"
          autocomplete="name">
        </ion-input>
      </ion-item>
      <ion-note color="danger" *ngIf="f.name.touched && f.name.invalid">
        Ingresa tu nombre (mín. 2 caracteres).
      </ion-note>

      <ion-item class="ion-margin-top">
        <ion-input
          label="Email"
          labelPlacement="floating"
          type="email"
          formControlName="email"
          autocomplete="email">
        </ion-input>
      </ion-item>
      <ion-note color="danger" *ngIf="f.email.touched && f.email.invalid">
        Email inválido.
      </ion-note>

      <ion-item class="ion-margin-top">
        <ion-input
          [type]="showPwd ? 'text' : 'password'"
          label="Contraseña"
          labelPlacement="floating"
          formControlName="password"
          autocomplete="new-password">
        </ion-input>
        <ion-button fill="clear" slot="end" (click)="showPwd=!showPwd" type="button">
          {{ showPwd ? 'Ocultar' : 'Ver' }}
        </ion-button>
      </ion-item>
      <ion-note color="danger" *ngIf="f.password.touched && f.password.invalid">
        Mínimo 6 caracteres.
      </ion-note>

      <ion-item class="ion-margin-top">
        <ion-input
          [type]="showCnf ? 'text' : 'password'"
          label="Confirmar contraseña"
          labelPlacement="floating"
          formControlName="confirm"
          autocomplete="new-password">
        </ion-input>
        <ion-button fill="clear" slot="end" (click)="showCnf=!showCnf" type="button">
          {{ showCnf ? 'Ocultar' : 'Ver' }}
        </ion-button>
      </ion-item>
      <ion-note color="danger" *ngIf="(f.confirm.touched || f.password.touched) && form.errors?.['notMatch']">
        Las contraseñas no coinciden.
      </ion-note>

      <!-- Toggle administrador -->
      <ion-item class="ion-margin-top">
        <ion-checkbox formControlName="isAdmin" labelPlacement="end">
          Soy administrador
        </ion-checkbox>
      </ion-item>

      <!-- Código de administrador (solo si isAdmin = true) -->
      <ion-item class="ion-margin-top" *ngIf="form.value.isAdmin">
        <ion-input
          label="Código de administrador"
          labelPlacement="floating"
          formControlName="adminCode"
          autocomplete="off">
        </ion-input>
      </ion-item>
      <ion-note color="danger"
                *ngIf="form.value.isAdmin && f.adminCode.touched && f.adminCode.invalid">
        Ingresa el código de administrador.
      </ion-note>

    </ion-list>

    <ion-button
      expand="block"
      class="ion-margin-top"
      type="submit"
      [disabled]="form.invalid || (form.value.isAdmin && f.adminCode.invalid)">
      {{ form.value.isAdmin ? 'Crear administrador' : 'Crear cuenta' }}
    </ion-button>

    <div class="ion-text-center ion-padding-top">
      <a [routerLink]="['/login']">Ya tengo cuenta</a>
    </div>
  </form>
</ion-content>
